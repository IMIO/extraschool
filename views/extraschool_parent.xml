<?xml version="1.0" ?>
<openerp>
	<data> 
        <record model="ir.ui.view" id="extraschool_parent_tree">
			<field name="name">extraschool.parent.tree</field>
			<field name="model">extraschool.parent</field>
			<field name="type">tree</field>
			<field name="arch" type="xml">
				<tree string="Parent">
                    <field name="lastname"/> 
                    <field name="firstname"/>
                    <field name="zipcode"/>			
                    <field name="email"/>
   				</tree>
			</field>
		</record>
        
        <record model="ir.ui.view" id="extraschool_parent_form">
            <field name="name">extraschool.parent.form</field>
            <field name="model">extraschool.parent</field>    
            <field name="type">form</field>
            <field name="arch" type="xml">
            <form string="Parents">
            	<group col="4">        
	            	<field name="isdisabled"/>
	                <newline/>
	            </group>            
                <notebook>
                <page string="Contact">
                    <group col="4">        
                    <field name="name" invisible="True"/>
                    <field name="streetcode" invisible="True"/>
                    <field name="lastname" on_change="onchange_name(lastname,firstname)"/> 
                    <field name="firstname" on_change="onchange_name(lastname,firstname)"/>        
                    <newline/>
                    <field name="street" on_change="onchange_address(street,city)"/>
                    <newline/>
                    <field name="zipcode"/>        
                    <field name="city" on_change="onchange_address(street,city)"/>
                    <newline/>
                    <field name="housephone"/>
                    <field name="workphone"/>
                    <newline/>
                    <field name="gsm"/>
                    <field name="email"/>
                    <newline/>
                    <field name="invoicesendmethod"/>
                    <newline/>
                    <field name="remindersendmethod"/>
                    <newline/>
                    </group>
                </page>
                <page string="Childs">
                    <group col="4">
                    <field name="child_ids" nolabel="1"/>
                    </group>
                </page>
                <page string="Invoices">
                    <group col="4">
                    <field name="totalinvoiced"/>
                    <newline/>
                    <field name="totalreceived"/>
                    <newline/>
                    <field name="totalbalance"/>
                    <newline/>
					<separator string="Factures" colspan="4"/>                    
                    <field name="invoice_ids" nolabel="1" colspan="4">
	                    <tree string="Invoices">
	                        <field name="activitycategoryid"/>
							<field name="structcom"/>	                        
	                        <field name="period_from"/>
	                        <field name="period_to"/>
	                        <field name="payment_term"/>
	                        <field name="amount_total" sum="True"/>
	                        <field name="amount_received" sum="True"/>
	                        <field name="balance"  sum="True"/>
	                        <field name="no_value"/>	
	                        <button name="reconcil" type="object" string="Reconcil"/>	                        
	                    </tree>
                    </field>
                    </group>
                </page>
                <page string="Reminders">
                    <group col="4">
                    <field name="reminder_ids" nolabel="1">
                    <tree string="Reminders" version="7.0">
                        <field name="activitycategoryid"/>
                        <field name="transmissiondate"/>
                        <field name="term"/>
                        <field name="amount" sum="True"/>
                    </tree>
                    </field>
                    </group>
                </page>
                <page string="Payment">
                	<button name="extraschool.action_lbsc_payment_wizard" string="Add payment Wizard" icon="gtk-apply" type="action" context="{'parent_id': id}"/>
                	<field name="payment_ids">
                		<tree editable="top" create="false" delete="false">
                			<field name="paymentdate"  readonly="True"/>
							<field name="paymenttype"  readonly="True"/>
							<field name="structcom" readonly="True"/>
							<field name="comment" />															
							<field name="amount" sum="True"  readonly="True"/>
							<field name="solde" />															
                		</tree>
                    </field>
                 </page>
                <page string="Payment status">
                    <field name="payment_status_ids" readonly="True">
					<tree colors="red:solde &lt; 0;">
                			<field name="activity_category_id" />
							<field name="solde" sum="True"/>
                		</tree>
                    </field>
                 </page>
                 </notebook>
                <!-- button name="return_action_to_open" type="object" context="{'xml_id':'action_extraschool_invoices'}" string="invoices" / -->
            </form>
            </field> 
        </record>
        
        <record id="extraschool_parent_search_view" model="ir.ui.view">
            <field name="name">extraschool_parent.search</field>
            <field name="model">extraschool.parent</field>
            <field name="arch" type="xml">
                <search string="Parent Search">
                   <field name="name"/>       
                   <filter string="Actif" name="actif" icon="terp-accessories-archiver" domain="[('isdisabled','=',False)]"/>                   	                                      	                   	         
                </search>
            </field>
        </record>
        
        
        <record model="ir.actions.act_window" id="action_lbsc_parent_invoices">
            <field name="name">Parent invoices</field>
            <field name="res_model">extraschool.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree, form</field>
        </record>

        <record model="ir.actions.act_window" id="action_extraschool_parent">
            <field name="name">Parent</field>
            <field name="res_model">extraschool.parent</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree, form</field>
            <field name="view_id" ref="extraschool_parent_tree"/>
            <field name="context">{"search_default_actif":1}</field>            	            
        </record>
        
        <record model="ir.actions.act_window.view" id="action_extraschool_parent_form">
			<field name="name">Parent</field>
            <field eval="2" name="sequence"/>
			<field name="res_model">extraschool.parent</field>
            <field name="view_mode">form</field>
            <field name="view_id" ref="extraschool_parent_form" />   
            <field name="act_window_id" ref="action_extraschool_parent" /> 
		</record> 
        
        <record model="ir.actions.act_window.view" id="action_extraschool_parent_tree">
			<field name="name">Parent</field>
            <field eval="1" name="sequence"/>
			<field name="res_model">extraschool.parent</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="extraschool_parent_tree" />  
            <field name="act_window_id" ref="action_extraschool_parent" /> 
		</record>
	</data>
</openerp>
