<?xml version="1.0" ?>
<openerp>
	<data> 
        <record model="ir.ui.view" id="extraschool_payment_form2">
			<field name="name">payment.form2</field>
			<field name="model">extraschool.payment</field>
            <field name="priority" eval="17"/>
			<field name="type">form</field>
			<field name="arch" type="xml">
				<form string="Payment">
					<group col="4">
                    <field name="paymentdate"/>
                    <newline/>
					<field name="amount"/>
                    <newline/>
                    <field name="paymenttype"/>
                    <newline/>
                    <field name="name"/>
                    <newline/>
                    <field name="account"/>
                    <newline/>
                    <field name="structcom"/>
                    <newline/>
                    <button name="savepayment" string="Save" icon="gtk-apply" type="object"/>
                    </group>
				</form>
			</field>
		</record>
		
         <record model="ir.ui.view" id="extraschool_payment_status_report_form">
            <field name="name">extraschool.payment_status_report.form</field>
            <field name="model">extraschool.payment_status_report</field>    
            <field name="type">form</field>
            <field name="arch" type="xml">
	            <form string="Payment Status">
					<group col="4">
		            	<field name="activity_category_id"/>
		                <field name="parent_id"/>
		                <field name="solde"/>
					</group>
		       </form>
            </field> 
        </record>
                                
         <record model="ir.ui.view" id="extraschool_payment_status_report_tree">
            <field name="name">extraschool.payment_status_report.tree</field>
            <field name="model">extraschool.payment_status_report</field>    
            <field name="type">tree</field>
            <field name="arch" type="xml">
	            <tree string="Payment Status">
		            	<field name="activity_category_id"/>
		                <field name="parent_id"/>
		                <field name="solde"/>
	            </tree>
            </field> 
        </record>

       <record id="extraschool_payment_status_report_graph" model="ir.ui.view">
            <field name="name">extraschool.payment_status_report.graph</field>
            <field name="model">extraschool.payment_status_report</field>
            <field name="arch" type="xml">
                <graph string="Payment Status" type="bar">
		            	<field name="activity_category_id" type="row"/>
		                <field name="parent_id"/>
		                <field name="solde" type="measure"/>
                 </graph>
             </field>
        </record>
        
         <record id="extraschool_payment_status_report_search_view" model="ir.ui.view">
            <field name="name">extraschool.payment_status_report.search</field>
            <field name="model">extraschool.payment_status_report</field>
            <field name="arch" type="xml">
                <search string="Guardian prestationtimes Search">
	            	<field name="activity_category_id"/>
	                <field name="parent_id"/>
	                <field name="solde"/>
                   <group  expand='0' string='Group by...'>
                       <filter string='activity_category_id' icon="terp-stock_symbol-selection" domain="[]" context="{'group_by' : 'activity_category_id'}"/>
                       <filter string='parent_id' icon="terp-stock_symbol-selection" domain="[]" context="{'group_by' : 'parent_id'}"/>
                   </group>                    
                </search>
            </field>
        </record>
                       
        <record model="ir.actions.act_window" id="action_payment_status_report">
			<field name="name">Payment Status Report</field>
			<field name="res_model">extraschool.payment_status_report</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,graph</field>
            <field name="view_id" ref="extraschool_payment_status_report_tree"/>
		</record>

        <!--Definition of an email template with an empty body that will be used in payment mailing. Used to give a
            basis for email recipients, name and to ease the definition of a further elaborated template. -->
        <record id="email_template_payment_invitation" model="email.template">
            <field name="name">Payment invitation mail</field>
            <field name="model_id" ref="model_extraschool_payment_status_report"/>
            <field name="auto_delete" eval="True"/>
            <field name="partner_to">${object.id}</field>
            <field name="email_from">${(object.activity_category_id.invoiceemailaddress or 'noreply@localhost')|safe}</field>
            <field name="reply_to">${(object.activity_category_id.invoiceemailaddress or 'noreply@localhost')|safe}</field>
            
        </record>

        <!--  Replace the default mass-mailing wizard in base with the composition wizard -->
        <act_window name="Payment invitation mail"
                res_model="mail.compose.message"
                src_model="extraschool.payment_status_report"
                view_mode="form"
                multi="True"
                target="new"
                key2="client_action_multi"
                id="extraschool.payment_invitation_mass_mail"
                context="{
                            'default_composition_mode': 'mass_mail',
                            'default_partner_to': '${object.id or \'\'}',
                            'default_use_template': True,
                            'default_template_id': ref('email_template_payment_invitation'),
                        }"/>

        <record id="email_payment_invitation" model="email.template">
            <field name="ref_ir_act_window" ref="extraschool.payment_invitation_mass_mail"/>
        </record>
				
	</data>
</openerp>
