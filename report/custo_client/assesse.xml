<?xml version="1.0" ?>
<odoo>
    <data>

        <template id="report_constraint_assesse">
            <xpath expr="//head" position="inside">
                <link rel="stylesheet" href="/extraschool/static/src/css/report_constraint_assesse.css"/>
            </xpath>
            <div class="text">
                <span class="object">Objet:</span>
                <t t-esc="reminder.reminders_journal_id.name"/>
                <br/>
                <br/>
                <br/>
                <h5 class="title centered">CONTRAINTE NON FISCALE</h5>
                <br/>
                Contrainte non fiscale décernée en exécution des articles L1124-40 et L1124-43 du Code de la démocratie
                locale et de la décentralisation, du Décret du 18.04.2013 (MB 22.08.2013) modifiant certaines
                dispositions du CDLD, notamment ses articles 26 et 53.
                <br/>
                <br/>

                Vu la décision du collège communal du
                <t t-esc="decision_date"/>
                visant et rendant exécutoire la présente contrainte, et
                renvoyant à la Directrice Financière l’émission et la signature de celle-ci;
                <br/>
                <br/>

                Je soussignée, Caroline ETIENNE, Directrice Financière de la Commune d’Assesse, agissant en exécution de
                l’article L1124-40 1er, relatif au recouvrement des créances non fiscales, et de toutes autres
                dispositions légales, réglementaires et constitutionnelles relatives au recouvrement et au
                contentieux;
                <br/>
                <br/>

                DÉLIVRE et SIGNE LA PRÉSENTE CONTRAINTE à charge du redevable cité ci-dessous, laquelle vaut titre
                exécutoire en vertu de la décision susvisée du Collège communal,
                <br/>
                <br/>

                MANDATE et ORDONNE à Maître CHARTIER Roland, Huissier de Justice à 5503 DINANT (Sorinnes), de se rendre
                au domicile du contribuable plus amplement désigné ci-dessous, lequel est en défaut de paiement de
                créance(s) non fiscale(s) en principal, intérêts et frais reprises en dernier feuillet, et de procéder à
                sa signification, suivie d’un commandement de payer à l’expiration du délai de recours contre la
                présente contrainte, à peine d’exécution par voie de saisie conformément aux dispositions du Code
                Judiciaire et, le cas échéant, de le poursuivre par toute voie de droit ainsi que toute personne qui
                pourrait être poursuivie en vertu de la présente contrainte et des dispositions légales susvisées.
                <br/>
                <br/>

                Le contribuable retardataire dispose d’un délai d’un mois dès signification de la présente contrainte
                non fiscale pour introduire un recours devant les cours et tribunaux compétents.
                <br/>
                <br/>


                <div style="display: flex; flex-direction: row;">
                    <span class="title" style="padding-right:30px;">Identification du redevable:</span>
                    <br/>
                    <br/>
                    <div>
                        <p>
                            <t t-esc="parent_id.lastname"/>
                            <t t-esc="parent_id.firstname"/>
                        </p>
                        <p>
                            <t t-esc="parent_id.rn"/>
                        </p>
                        <p>
                            <t t-esc="parent_id.street"/>
                        </p>
                        <p>
                            <t t-esc="parent_id.zipcode"/>
                            <t t-esc="parent_id.city"/>
                        </p>
                    </div>
                </div>
                <br/>


                <span class="title">Détail de la dette :</span>
                <br/>
                <br/>
                <ul>
                    <li>Règlement en vigueur (ou règlement concerné) :
                        <t t-esc="regulation_date"/>
                    </li>
                    <li>Libellé de la créance :
                        <t t-esc="activity_category.name"/>
                    </li>
                    <li>Date du recommandé :
                        <t t-esc="recommended_date"/>
                    </li>
                    <li>Montant total dû :
                        <t t-esc="balance_computed"/>
                        €
                    </li>
                </ul>
                <br/>
            </div>

        </template>

        <template id="report_invoice_summary_assesse_tableau_rappel">
            <xpath expr="//head" position="inside">
                <link rel="stylesheet"
                      href="/extraschool/static/src/css/report_invoice_summary_tournai_tableau_rappel.css"/>
            </xpath>
            <div>
                <span class="title">Détail des sommes dûes :</span>
                <br/>
                <br/>

                <br/>
                <br/>
            </div>
            <div id="invoice_summary">
                <p>
                    <span style="font-decoration:underline; font-size: 15px;">Liste des factures couvrant cette
                        période
                    </span>
                </p>
                <br/>
                <table>
                    <tr>
                        <th>Facture n°</th>
                        <th>Période facturée</th>
                        <th>Montant</th>
                        <th>Correction</th>
                        <th>Paiement</th>
                        <th>Solde restant dû</th>
                    </tr>
                    <t t-foreach="summary_invoice_ids.sorted(key=lambda r: r.number)" t-as="summary_invoice">
                        <tr>
                            <t t-if="summary_invoice.id != invoice_id">
                                <tr>
                                    <td>
                                        <span t-field="summary_invoice.number"/>
                                    </td>
                                    <td>
                                        <span
                                            t-esc="'%s' % (time.strftime('%d-%m-%Y',time.strptime(summary_invoice.biller_id.period_from,'%Y-%m-%d')))"/>
                                        -
                                        <span
                                            t-esc="'%s' % (time.strftime('%d-%m-%Y',time.strptime(summary_invoice.biller_id.period_to,'%Y-%m-%d')))"/>
                                    </td>
                                    <td>
                                        <span t-esc="'%.2f €' % (summary_invoice.amount_total)"/>
                                    </td>
                                    <td>
                                        <span t-esc="'%.2f €' % (summary_invoice.no_value_amount)"/>
                                    </td>
                                    <td>
                                        <span t-esc="'%.2f €' % (summary_invoice.amount_received)"/>
                                    </td>
                                    <td class="amount">
                                        <span t-esc="'%.2f €' % (summary_invoice.balance)"/>
                                    </td>
                                </tr>
                            </t>
                        </tr>
                    </t>
                    <tr>
                        <th colspan="2">TOTAUX</th>
                        <th>
                            <span
                                t-esc="'%.2f €' % (sum([summary_invoice.amount_total for summary_invoice in summary_invoice_ids]))"/>
                        </th>
                        <th>
                            <span
                                t-esc="'%.2f €' % (sum([summary_invoice.no_value_amount for summary_invoice in summary_invoice_ids]))"/>
                        </th>
                        <th>
                            <span
                                t-esc="'%.2f €' % (sum([summary_invoice.amount_received for summary_invoice in summary_invoice_ids]))"/>
                        </th>
                        <th style="text-align:right;">
                            <span
                                t-esc="'%.2f €' % (sum([summary_invoice.balance for summary_invoice in summary_invoice_ids]))"/>
                        </th>
                    </tr>
                </table>
            </div>
            <br/>
            Contrainte non fiscale visée et rendue exécutoire par le Collège Communal d‘Assesse en sa
            séance du
            <t t-esc="decision_date"/>
        </template>

        <template id="report_invoice_summary_impaye_assesse">
            <t t-set="zz" t-value="0"/>
            <t t-foreach="summary_invoice_ids" t-as="summary_invoice">
                <t t-if="summary_invoice.id != invoice_id">
                    <t t-set="zz" t-value="zz+1"/>
                </t>
            </t>
            <t t-if="zz">
                <xpath expr="//head" position="inside">
                    <link rel="stylesheet" href="/extraschool/static/src/css/report_invoice_summary.css"/>
                </xpath>
                <div id="invoice_summary">
                    <h2>Facture(s) impayée(s)</h2>
                    <p>Les factures suivantes sont toujours en attente de paiement. Nous vous prions de bien vouloir
                        procéder à leur(s) règlement(s) dans les meilleurs délais.
                    </p>
                    <table>
                        <tr>
                            <th>Période</th>
                            <th>Facture</th>
                            <th>Catégorie</th>
                            <th>Echéance</th>
                            <th>Montant</th>
                        </tr>
                        <t t-foreach="summary_invoice_ids.sorted(key=lambda r: r.number)" t-as="summary_invoice">
                            <tr>
                                <t t-if="summary_invoice.id != invoice_id and summary_invoice.activitycategoryid == categ_id">
                                    <t t-if="summary_invoice.reminder_fees == False">
                                        <tr>
                                            <td>
                                                <span
                                                    t-esc="'%s' % (time.strftime('%d-%m-%Y',time.strptime(summary_invoice.biller_id.period_from,'%Y-%m-%d')))"/>
                                                -
                                                <span
                                                    t-esc="'%s' % (time.strftime('%d-%m-%Y',time.strptime(summary_invoice.biller_id.period_to,'%Y-%m-%d')))"/>
                                            </td>
                                            <td>
                                                <span t-field="summary_invoice.number"/>
                                            </td>
                                            <td>
                                                <t t-foreach="summary_invoice.activitycategoryid"
                                                   t-as="category_activity">
                                                    <span t-field="category_activity.name"/>
                                                </t>
                                            </td>
                                            <td>
                                                <span t-field="summary_invoice.payment_term"/>
                                            </td>
                                            <td class="amount">
                                                <span t-esc="'%.2f €' %  (summary_invoice.balance)"/>
                                            </td>

                                        </tr>
                                    </t>
                                    <t t-if="summary_invoice.reminder_fees == True">
                                        <t t-foreach="summary_invoice.invoice_line_ids" t-as="invoice_line">
                                            <tr>
                                                <td></td>
                                                <td>
                                                    <t t-foreach="summary_invoice.activitycategoryid"
                                                       t-as="category_activity">
                                                        <span t-field="category_activity.name"/>
                                                    </t>
                                                </td>
                                                <td>
                                                    <span t-field="invoice_line.description"/>
                                                </td>
                                                <td>
                                                    <span t-field="summary_invoice.payment_term"/>
                                                </td>
                                                <td class="amount">
                                                    <span t-esc="TODO"/>
                                                </td>
                                                <!--<td class="amount"><span t-esc="'%.2f €' %  (invoice_line.balance)" /></td>-->
                                            </tr>
                                        </t>
                                    </t>
                                </t>
                            </tr>
                        </t>

                    </table>
                </div>
            </t>

        </template>

        <template id="report_invoice_summary_assesse">
            <t t-set="zz" t-value="0"/>
            <t t-foreach="summary_invoice_ids" t-as="summary_invoice">
                <t t-if="summary_invoice.id != invoice_id">
                    <t t-set="zz" t-value="zz+1"/>
                </t>
            </t>
            <t t-if="zz">
                <xpath expr="//head" position="inside">
                    <link rel="stylesheet" href="/extraschool/static/src/css/report_invoice_summary.css"/>
                </xpath>
                <div id="invoice_summary">
                    <h2>
                        <span t-esc="summary_invoice_title"/>
                    </h2>
                    <p>Les factures suivantes sont toujours en attente de paiement. Nous vous prions de bien vouloir
                        procéder à leur(s) règlement(s) dans les meilleurs délais.
                    </p>
                    <table>
                        <tr>
                            <th>Période</th>
                            <th>Facture</th>
                            <th>Echéance</th>
                            <th>Montant</th>
                        </tr>
                        <t t-foreach="summary_invoice_ids.sorted(key=lambda r: r.number)" t-as="summary_invoice">
                            <tr>
                                <t t-if="summary_invoice.id != invoice_id and summary_invoice.activitycategoryid == categ_id">
                                    <t t-if="summary_invoice.reminder_fees == False">
                                        <tr>
                                            <td>
                                                <span
                                                    t-esc="'%s' % (time.strftime('%d-%m-%Y',time.strptime(summary_invoice.biller_id.period_from,'%Y-%m-%d')))"/>
                                                -
                                                <span
                                                    t-esc="'%s' % (time.strftime('%d-%m-%Y',time.strptime(summary_invoice.biller_id.period_to,'%Y-%m-%d')))"/>
                                            </td>
                                            <td>
                                                <span t-field="summary_invoice.number"/>
                                            </td>
                                            <td>
                                                <span t-field="summary_invoice.payment_term"/>
                                            </td>
                                            <td class="amount">
                                                <span t-esc="'%.2f €' %  (summary_invoice.balance)"/>
                                            </td>

                                        </tr>
                                    </t>
                                    <t t-if="summary_invoice.reminder_fees == True">
                                        <t t-foreach="summary_invoice.invoice_line_ids" t-as="invoice_line">
                                            <tr>
                                                <td></td>
                                                <td>
                                                    <span t-field="invoice_line.description"/>
                                                </td>
                                                <td>
                                                    <span t-field="summary_invoice.payment_term"/>
                                                </td>
                                                <td class="amount">
                                                    <span t-esc="TODO"/>
                                                </td>
                                                <!--<td class="amount"><span t-esc="'%.2f €' %  (invoice_line.balance)" /></td>-->
                                            </tr>
                                        </t>
                                    </t>
                                </t>
                            </tr>
                        </t>

                    </table>
                </div>
            </t>

        </template>

    </data>
</odoo>
