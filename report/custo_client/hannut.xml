<?xml version="1.0" ?>
<odoo>
    <data>

        <template id="report_hannut_body_style">
            <style type="text/css">
                body {
                font-family:Calibri !important;
                src: url('/extraschool/static/font/calibri.ttf') format('truetype');
                text-align: justify;
                text-justify: inter-word;
                }
            </style>
        </template>


        <template id="report_hannut_all_invoice_summary" inherit_id="extraschool.report_all_invoice_summary"
                  primary="True">
            <xpath expr="//div[@id='invoice_summary']" position="before">
                <style type="text/css">
                    div#invoice_summary h2{
                    font-size:12px;
                    }
                    div#invoice_summary p{
                    font-size:9px;
                    }
                    div#invoice_summary p{
                    font-size: 12px;
                    }
                </style>
            </xpath>

            <xpath expr="//div[@id='invoice_summary']/p[1]" position="inside">
                <span>Les éventuels recouvrements qui seraient à charge d’un huissier ne sont
                    pas pris en compte sur le présent document. Toute réclamation relative à la facture doit être
                    transmise à l’asbl
                    L’Eveil avant la date d'échéance. Toute facture non contestée est considérée comme acceptée.
                </span>
            </xpath>
        </template>

        <template id="report_hannut_report_parent_credit" inherit_id="extraschool.report_parent_credit" primary="True">
            <xpath expr="//div[@id='aes_html_parent_credit']" position="replace">
                <div class="aes_html_parent_credit">
                    <h4>Pour rappel,</h4>
                    <p>Votre compte famille présente
                        <t t-if="parent_id.totalbalance > 0.001">
                            <span class="aes_credit_solde">un solde à payer de <t
                                t-esc="'%.2f' %  (parent_id.totalbalance)"/>€
                            </span>
                        </t>
                        <t t-if="parent_id.totalbalance &lt; 0.001">
                            <span class="aes_credit_solde">une avance de<t
                                t-esc="'%.2f' %  (parent_id.payment_status_ids[0].solde)"/>€
                            </span>
                        </t>
                    </p>

                </div>
            </xpath>
        </template>

        <template id="report_report_parent_credit_plusieurs_categ" inherit_id="extraschool.report_parent_credit"
                  primary="True">
            <xpath expr="//div[@id='aes_html_parent_credit']" position="replace">
                <div class="aes_html_parent_credit">
                    <h4>Pour rappel,</h4>
                    <p>Votre compte famille présente
                        <t t-if="parent_id.totalbalance > 0.001">
                            <span class="aes_credit_solde">un solde à payer de<t
                                t-esc="'%.2f' %  (parent_id.totalbalance)"/>€
                            </span>
                        </t>
                        <t t-if="parent_id.totalbalance &lt; 0.001">
                            <span class="aes_credit_solde">une avance de<t
                                t-esc="'%.2f' % (sum([total.solde for total in parent_id.payment_status_ids]))"/>€
                            </span>
                        </t>
                    </p>

                </div>
            </xpath>
        </template>

        <template id="report_all_invoice_summary_hannut_facture" inherit_id="extraschool.report_all_invoice_summary"
                  primary="True">
            <xpath expr="//div[@id='invoice_summary']" position="replace">
                <div id="invoice_summary">
                    <h2>Facture(s) échue(s) ou en attente de paiement</h2>
                    <p>Les factures suivantes sont toujours en attente de paiement. Nous vous prions de bien vouloir
                        procéder à leur(s) règlement(s) dans les meilleurs délais. Si un paiement mentionné dans le
                        tableau ci-dessous et notre courrier devaient se croiser, veuillez considérer ce paiement comme
                        nul et non avenu.
                    </p>
                    <table>
                        <tr>
                            <th>Période</th>
                            <th>Facture</th>
                            <th>Echéance</th>
                            <th>Montant</th>
                        </tr>
                        <t t-foreach="all_invoice_ids.sorted(key=lambda r: r.number).filtered(lambda r: r.tag != 'huissier')" t-as="summary_invoice">
                            <tr>
                                <t t-if="summary_invoice.id != invoice_id">
                                    <!--<t t-if="summary_invoice.reminder_fees == False">-->
                                    <tr>
                                        <td>
                                            <span
                                                t-esc="'%s' % (time.strftime('%d/%m/%Y',time.strptime(summary_invoice.biller_id.period_from,'%Y-%m-%d')))"/>
                                            -
                                            <span
                                                t-esc="'%s' % (time.strftime('%d/%m/%Y',time.strptime(summary_invoice.biller_id.period_to,'%Y-%m-%d')))"/>
                                        </td>
                                        <td>
                                            <span t-field="summary_invoice.number"/>
                                        </td>
                                        <td>
                                            <span t-field="summary_invoice.payment_term"/>
                                        </td>
                                        <td class="amount">
                                            <span t-esc="'%.2f€' %  (summary_invoice.balance)"/>
                                        </td>

                                    </tr>
                                    <!--</t>-->
                                    <!--<t t-if="summary_invoice.reminder_fees == True">-->
                                    <!--<t t-foreach="summary_invoice.invoice_line_ids" t-as="invoice_line">-->
                                    <!--<tr>-->
                                    <!--<td></td>-->
                                    <!--<td><span t-field="invoice_line.description" /></td>-->
                                    <!--<td><span t-field="summary_invoice.payment_term" /></td>-->
                                    <!--<td class="amount"><span t-esc="'%.2f€' %  (invoice_line.balance)" /></td>-->
                                    <!--</tr>-->
                                    <!--</t>-->
                                    <!--</t>-->
                                </t>
                            </tr>
                        </t>

                    </table>
                </div>
            </xpath>
        </template>

        <template id="report_dour_report_parent_credit" inherit_id="extraschool.report_parent_credit" primary="True">
            <xpath expr="//div[@id='aes_html_parent_credit']" position="replace">
                <div class="aes_html_parent_credit">
                    <h4>Pour rappel,</h4>
                    <p>Votre compte famille présente
                        <t t-if="parent_id.totalbalance > 0.001">
                            <span class="aes_credit_solde">un solde à payer de<t
                                t-esc="'%.2f' %  (parent_id.totalbalance - balance )"/>€
                            </span>
                        </t>
                        <t t-if="parent_id.totalbalance &lt; 0.001">
                            <span class="aes_credit_solde">une avance de<t
                                t-esc="'%.2f' %  (parent_id.payment_status_ids[0].solde)"/>€
                            </span>
                        </t>
                    </p>

                </div>
            </xpath>
        </template>

        <template id="report_hannut_all_invoice_summary_hannut_facture"
                  inherit_id="extraschool.report_all_invoice_summary_hannut_facture" primary="True">
            <xpath expr="//div[@id='invoice_summary']" position="before">
                <xpath expr="//head" position="inside">
                    <link rel="stylesheet"
                          href="/extraschool/static/src/css/report_hannut_all_invoice_summary_hannut_facture.css"/>
                </xpath>
            </xpath>

            <xpath expr="//div[@id='invoice_summary']/p[1]" position="inside">
                <span>Les éventuels recouvrements qui seraient à charge d’un huissier ne sont
                    pas pris en compte sur le présent document. Toute réclamation relative à la facture doit être
                    transmise à l’asbl
                    L’Eveil avant la date d'échéance. Toute facture non contestée est considérée comme acceptée.
                </span>
            </xpath>
        </template>

        <template id="report_invoice_summary_hannut">
            <t t-set="zz" t-value="0"/>
            <t t-foreach="summary_invoice_ids" t-as="summary_invoice">
                <t t-if="summary_invoice.id != invoice_id">
                    <t t-set="zz" t-value="zz+1"/>
                </t>
            </t>
            <t t-if="zz">
                <xpath expr="//head" position="inside">
                    <link rel="stylesheet" href="/extraschool/static/src/css/report_invoice_summary.css"/>
                </xpath>
                <div id="invoice_summary">
                    <h2>
                        <span t-esc="reminder.reminders_journal_id.name"/>
                    </h2>
                    <p>Madame, Monsieur, Chers Parents,
                        <br/>
                        Nous constatons que vous n'avez pas réglé votre/vos facture(s) de l'accueil extrascolaire.
                        Vous trouverez ci-dessous le détail de celle(s)-ci concernant la période mentionnée et l'ajout
                        de <b>3 €</b> de frais administratifs.
                    </p>
                    <table>
                        <tr>
                            <th>Période</th>
                            <th>Facture</th>
                            <th>Echéance</th>
                            <th>Montant</th>
                        </tr>
                        <!--                        A changer : faire un meilleur tri et standardiser-->
                        <t t-foreach="summary_invoice_ids.sorted(key=lambda r: r.number)" t-as="summary_invoice">
                            <tr>
                                <t t-if="summary_invoice.id != invoice_id">
                                    <t t-if="summary_invoice.reminder_fees == False">
                                        <tr>
                                            <td>
                                                <span
                                                    t-esc="'%s' % (time.strftime('%d-%m-%Y',time.strptime(summary_invoice.biller_id.period_from,'%Y-%m-%d')))"/>
                                                -
                                                <span
                                                    t-esc="'%s' % (time.strftime('%d-%m-%Y',time.strptime(summary_invoice.biller_id.period_to,'%Y-%m-%d')))"/>
                                            </td>
                                            <td>
                                                <span t-field="summary_invoice.number"/>
                                            </td>
                                            <td>
                                                <span t-field="summary_invoice.payment_term"/>
                                            </td>
                                            <td class="amount">
                                                <span t-esc="'%.2f €' %  (summary_invoice.balance)"/>
                                            </td>

                                        </tr>
                                    </t>
                                    <t t-if="summary_invoice.reminder_fees == True">
                                        <t t-foreach="summary_invoice.invoice_line_ids" t-as="invoice_line">
                                            <t t-if="summary_invoice.biller_id != biller_id">
                                                <tr>
                                                    <td></td>
                                                    <td>
                                                        <span t-field="invoice_line.description"/>
                                                    </td>
                                                    <td>
                                                        <span t-field="summary_invoice.payment_term"/>
                                                    </td>
                                                    <td class="amount">
                                                        <span t-esc="'%.2f €' %  (summary_invoice.balance)"/>
                                                    </td>
                                                </tr>
                                            </t>
                                        </t>
                                    </t>
                                </t>
                            </tr>
                        </t>
                    </table>
                </div>
            </t>

        </template>

                <template id="report_payment_info_amount_one_row_hannut">
            <xpath expr="//head" position="inside">
                <link rel="stylesheet"
                      href="/extraschool/static/src/css/report_payment_info_amount_one_row_hannut.css"/>
            </xpath>
            <div id="total_row">

                <div id="payment_info">
                    <span>Compte:
                        <b>
                            <t t-esc="categ_id.bankaccount"/>
                        </b>
                    </span>
                    <br/>
                    <span>BIC:
                        <t t-esc="categ_id.bank_bic"/>
                    </span>
                    <br/>
                    <div class="com_struct">
                        <span>Communication structurée <b>obligatoire</b>:
                            <br/>
                            <b>
                                <t t-esc="com_struct"/>
                            </b>
                        </span>
                    </div>
                </div>
                <div id="total">
                    <div class="amount">
                        <span class="zz_label">Total</span>
                        <span class="amount">
                            <t t-esc="'%.2f' %  (balance_computed - fees)"/>
                            €
                        </span>
                    </div>
                    <!--<div class="amount" t-if="received != 0">
                        <span class="zz_label">Reçu</span>
                        <span class="amount">
                            <t t-esc="'%.2f' %  (received)"/>
                            €
                        </span>
                    </div>-->
                    <div class="amount" t-if="reminder_type == 'fix'">
                        <span class="zz_label">Frais de rappel</span>
                        <span class="amount">
                            <t t-esc="'%.2f' %  (fees)"/>
                            €
                        </span>
                    </div>
                    <div class="amount to_pay" t-if="reminder_type == 'fix'">
                        <span class="zz_label">Solde</span>
                        <span class="amount">
                            <t t-esc="'%.2f' %  (balance_computed)"/>
                            €
                        </span>
                    </div>
                    <div class="amount to_pay" t-if="reminder_type == 'free'">
                        <span class="zz_label">Solde</span>
                        <span class="amount">
                            <t t-esc="'%.2f' %  (balance_computed)"/>
                            €
                        </span>
                    </div>
                    <div class="amount to_pay" t-if="not reminder_type">
                        <span class="zz_label">Solde</span>
                        <span class="amount">
                            <t t-esc="'%.2f' %  (balance)"/>
                            €
                        </span>
                    </div>
                    <div class="amount to_pay">
                        <b>
                            <span>A payer avant le
                                <t t-esc="payment_term"/>
                            </span>
                        </b>
                    </div>
                </div>
            </div>
        </template>

    </data>
</odoo>
