<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
		<template id="report_std_header_durbuy">
		    <xpath expr="//head" position="inside">
                <link rel="stylesheet" href="/extraschool/static/src/css/report_std_header_durbuy.css"/>
            </xpath>
		    <div id="aes_header"></div>
		    	<div>
						<img class="logo" t-attf-src="data:image/jpeg;base64,{{logo_reminder}}"/>
		    	</div>

            <div id="b_date">
                <span class="doc_date"><t t-esc="doc_date" /></span>
            </div>
		</template>

         <template id="report_invoice_summary_durbuy_rappel">
			<t t-set="zz" t-value="0" />
			<t t-foreach="summary_invoice_ids" t-as="summary_invoice">
				<t t-if="summary_invoice.id != invoice_id">
					<t t-set="zz" t-value="zz+1" />
				</t>
			</t>
			<t t-if="zz" >
                <xpath expr="//head" position="inside">
                    <link rel="stylesheet" href="/extraschool/static/src/css/report_invoice_summary_durbuy.css"/>
                </xpath>
                <div class="row">
                    <div class="col-sm-12">
                        <div id="invoice_summary" >
                            <h2>RAPPEL</h2>
                            <p>Madame, Monsieur, Cher parent,<br/><br/>
                                <span style="margin:30px;">Sauf erreur de notre part, votre compte présente un solde en notre faveur. Veuillez trouvez, ci-dessous, le détail de la/ des facture(s) de l'accueil
                                    Extrascolaire dont la somme reste impayée.</span><br/><br/>
                            </p>
                                <table class="col-sm-12">
                                    <tr>
                                        <th>Période</th>
                                        <th>Facture</th>
                                        <th>Montant dû</th>
                                        <th>Montant payé</th>
                                        <th>Solde</th>
                                    </tr>
                                    <t t-foreach="summary_invoice_ids.sorted(key=lambda r: r.number)" t-as="summary_invoice">
                                        <tr>
                                            <t t-if="summary_invoice.id != invoice_id">
                                            <t t-if="summary_invoice.reminder_fees == False">
                                                <tr>
                                                    <td><span t-esc="'%s' % (time.strftime('%d-%m-%Y',time.strptime(summary_invoice.biller_id.period_from,'%Y-%m-%d')))" /> - <span t-esc="'%s' % (time.strftime('%d-%m-%Y',time.strptime(summary_invoice.biller_id.period_to,'%Y-%m-%d')))" /></td>
                                                    <td class="amount"><span t-field="summary_invoice.number" /></td>
                                                    <td class="amount"><span t-esc="'%.2f €' % (summary_invoice.amount_total)"/></td>
                                                    <td class="amount"><span t-esc="'%.2f €' % (summary_invoice.amount_received)" /></td>
                                                    <td class="amount"><span t-esc="'%.2f €' %  (summary_invoice.balance)" /></td>
                                                </tr>
                                            </t>
                                            <t t-if="summary_invoice.reminder_fees == True">
                                                <t t-foreach="summary_invoice.invoice_line_ids" t-as="invoice_line">
                                                    <tr>
                                                        <td><span t-esc="'%s' % (time.strftime('%d-%m-%Y',time.strptime(summary_invoice.biller_id.period_from,'%Y-%m-%d')))" /> - <span t-esc="'%s' % (time.strftime('%d-%m-%Y',time.strptime(summary_invoice.biller_id.period_to,'%Y-%m-%d')))" /></td>
                                                        <td class="amount"><span t-field="summary_invoice.number" /></td>
                                                        <td class="amount"><span t-esc="'%.2f €' % (summary_invoice.amount_total)"/></td>
                                                        <td class="amount"><span t-esc="'%.2f €' % (summary_invoice.amount_received)" /></td>
                                                        <td class="amount"><span t-esc="'%.2f €' %  (summary_invoice.balance)" /></td>
                                                    </tr>
                                                </t>
                                            </t>
                                            </t>
                                        </tr>
                                    </t>
                                </table>
                        </div>
                    </div>
                </div>
			</t>

		</template>

        <template id="report_payment_info_amount_one_row_durbuy_rappel">
            <xpath expr="//head" position="inside">
                <link rel="stylesheet" href="/extraschool/static/src/css/report_payment_info_amount_one_row_durbuy_rappel.css"/>
            </xpath>
            <div class="row">
                <div class="col-sm-12">
                    <div  style="border-width: 1px;display:block;border-style: solid;width: 100%;page-break-inside: avoid;font-size: 13px;">
                        <div id="payment_info">
                            <span style="font-size: 15px;font-weight: bold;">Total à payer : <span style="float:right;"><t t-esc="'%.2f' %  (total)" /> €</span></span><br/>
                            <span>Échéance <span style="float:right;">avant le <t t-esc="payment_term" /></span></span><br/>
                            <span>Compte <span style="float:right;"><t t-esc="categ_id.bankaccount" /></span></span><br/>
                            <span>Communication structurée <span class="ecrit">obligatoire</span> <span style="float:right;"><t t-esc="reminder_com_struct"/></span></span>
                        </div>
                    </div>
                    <div style="margin-top:15px;">
                        <p>
                            <br/><span style="margin:30px;">En l'absence de contestation, nous vous invitons à procéder au paiement en respectant le délai, le numéro de compte, ainsi
                                que la communication mentionnés ci-dessus.<sup>1</sup><br/></span>
                        </p>
                        <p>
                            <span style="margin:30px;">À défaut de paiement dans le délai imparti, une mise en demeure recommandée majorée de 7,50€ vous sera adressée.<br/></span>
                        </p>
                        <p>
                            <span style="margin:30px;">Nous vous prions de croire, Madame, Monsieur, Cher parent, en l'assurance de notre considération distinguée.<br/></span>
                        </p>
                    </div>
                </div>
                <div class="col-sm-3" style="float: right;display:block;margin-top:10px;">
                    <div style="display:block;">
                        <span t-esc="resp_name" /><br/>
                        <span style="border-top:30px;"> <t t-esc="resp_fct"/> </span>
                    </div>
                </div>
            </div>

		</template>

        <template id="report_std_footer_durbuy_rappel">
		    <div class="col-sm-12" style="margin-top:100px; font-size:12px">
                <sup>1</sup> Si votre paiement croise ce courrier, veuillez considérer ce rappel comme nul et non avenu.
            </div>
		</template>

        <template id="report_invoice_summary_durbuy">
			<t t-set="zz" t-value="0" />
			<t t-foreach="summary_invoice_ids" t-as="summary_invoice">
				<t t-if="summary_invoice.id != invoice_id">
					<t t-set="zz" t-value="zz+1" />
				</t>
			</t>
			<t t-if="zz" >
			    <style type="text/css">
			        #invoice_summary{
			    		width: 100%;
			    		display: block;
			    		margin: 0cm 0cm 0cm 0cm;
			    		page-break-inside: avoid;
			    		text-align: justify;
			    		text-justify: inter-word;
			    		font-size: x-small;
			    	}

			    	#invoice_summary div.your_ref{
			    		width: 100%;
			    		padding: 5mm 0mm 5mm 0mm;
			    		display: block;
			    	}

					#invoice_summary table {
			    		width: 100%;
						font-size:11px;
						border-width: 1px;
						border-collapse: collapse;
					}
					#invoice_summary table th {
						border-width: 1px;
						padding: 4px;
						border-style: solid;
						background-color: #dedede;
					}
					#invoice_summary table td {
						border-width: 1px;
						padding: 4px;
						border-style: solid;
					}

					#invoice_summary table td.amount {
			    		text-align: right;
			    		width: 20%;
					}

					div#invoice_summary h2{
			    		font-size: 12px;
			    		font-weight: bold;
			    	}

				</style>

	        	<div id="invoice_summary" >
	        		<h2>Facture(s) échue(s) ou en attente de paiement</h2>
					<p>
						Les factures suivantes sont toujours en attente de paiement. Nous vous prions de bien vouloir
						procéder à
						leur(s) règlement(s) dans les meilleurs délais. Si un paiement mentionné dans le tableau ci-dessous
						et notre
						courrier devaient se croiser, veuillez considérer ce paiement comme nul et non avenu. Les
						éventuels
						recouvrements qui seraient à charge d’un huissier ne sont pas pris en compte sur le présent
						document.
						Toute réclamation relative à la facture doit être transmise à la Ville de Durbuy, coordination
						enfance, avant la date d'échéance. Toute facture non contestée est considérée comme acceptée.
					</p>
	        		<table>
	        			<tr>
		        			<th>Période</th>
		        			<th>Facture</th>
		        			<th>Echéance</th>
		        			<th>Montant</th>
						</tr>
		       			<t t-foreach="summary_invoice_ids.sorted(key=lambda r: r.number)" t-as="summary_invoice">
	        				<tr>
	        					<t t-if="summary_invoice.id != invoice_id">
	        					<t t-if="summary_invoice.reminder_fees == False">
	        						<tr>
				       					<td><span t-esc="'%s' % (time.strftime('%d-%m-%Y',time.strptime(summary_invoice.biller_id.period_from,'%Y-%m-%d')))" /> - <span t-esc="'%s' % (time.strftime('%d-%m-%Y',time.strptime(summary_invoice.biller_id.period_to,'%Y-%m-%d')))" /></td>
			        					<td><span t-field="summary_invoice.number" /></td>
				       					<td><span t-field="summary_invoice.payment_term" /></td>
				       					<td class="amount"><span t-esc="'%.2f €' %  (summary_invoice.balance)" /></td>

	        						</tr>
								</t>
	        					<t t-if="summary_invoice.reminder_fees == True">
	        						<t t-foreach="summary_invoice.invoice_line_ids" t-as="invoice_line">
	        							<tr>
					       					<td></td>
				        					<td><span t-field="invoice_line.description" /></td>
					       					<td><span t-field="summary_invoice.payment_term" /></td>
					       					<td class="amount"><span t-esc="'%.2f €' %  (summary_invoice.balance)" /></td>
				       					</tr>
	        						</t>
								</t>
								</t>
		       				</tr>
		        		</t>

	        		</table>
	       		</div>
			</t>
		</template>


        <template id="report_adresse_no_style_durbuy">
			<xpath expr="//head" position="inside">
                <link rel="stylesheet" href="/extraschool/static/src/css/report_adresse_no_style.css"/>
            </xpath>
	    	<div class="aes_adresse">
				<div class="aes_adresse_block customer">
					<span t-field="addresse.name" />
					<span t-field="addresse.street" />
					<span><t t-esc="addresse.zipcode" /> <t t-esc="addresse.city" /></span>
				</div>
			</div>
		</template>

        <template id="report_invoice_summary_durbuy_med">
			<t t-set="zz" t-value="0" />
			<t t-foreach="summary_invoice_ids" t-as="summary_invoice">
				<t t-if="summary_invoice.id != invoice_id">
					<t t-set="zz" t-value="zz+1" />
				</t>
			</t>
			<t t-if="zz" >
                <xpath expr="//head" position="inside">
                    <link rel="stylesheet" href="/extraschool/static/src/css/report_invoice_summary_durbuy.css"/>
                </xpath>
                <div class="row">
                    <div class="col-sm-12">
                        <div id="invoice_summary" >
                            <h3>MISE EN DEMEURE RECOMMANDEE</h3>
                            <p>Madame, Monsieur, Cher parent,<br/><br/>
                                <span style="margin:30px;">Sauf erreur de notre part, vous n'avez pas donné suite à notre premier rappel vous invitant à solder la/les facture(s)
                                 de l'accueil extrascolaire ci-dessous.</span><br/><br/>
                            </p>
                                <table class="col-sm-12">
                                    <tr>
                                        <th>Période</th>
                                        <th>Facture</th>
                                        <th>Montant dû</th>
                                        <th>Montant payé</th>
                                        <th>Solde</th>
                                    </tr>
                                    <t t-foreach="summary_invoice_ids.sorted(key=lambda r: r.number)" t-as="summary_invoice">
                                        <tr>
                                            <t t-if="summary_invoice.id != invoice_id">
                                            <t t-if="summary_invoice.reminder_fees == False">
                                                <tr>
                                                    <td><span t-esc="'%s' % (time.strftime('%d-%m-%Y',time.strptime(summary_invoice.biller_id.period_from,'%Y-%m-%d')))" /> - <span t-esc="'%s' % (time.strftime('%d-%m-%Y',time.strptime(summary_invoice.biller_id.period_to,'%Y-%m-%d')))" /></td>
                                                    <td class="amount"><span t-field="summary_invoice.number" /></td>
                                                    <td class="amount"><span t-esc="'%.2f €' % (summary_invoice.amount_total)"/></td>
                                                    <td class="amount"><span t-esc="'%.2f €' % (summary_invoice.amount_received)" /></td>
                                                    <td class="amount"><span t-esc="'%.2f €' %  (summary_invoice.balance)" /></td>
                                                </tr>
                                            </t>
                                            <t t-if="summary_invoice.reminder_fees == True">
                                                <t t-foreach="summary_invoice.invoice_line_ids" t-as="invoice_line">
                                                    <tr>
                                                        <td></td>
                                                        <td class="amount"><span t-field="summary_invoice.number" /></td>
                                                        <td class="amount"><span t-esc="'%.2f €' % (summary_invoice.amount_total)"/></td>
                                                        <td class="amount"><span t-esc="'%.2f €' % (summary_invoice.amount_received)" /></td>
                                                        <td class="amount"><span t-esc="'%.2f €' %  (summary_invoice.balance)" /></td>
                                                    </tr>
                                                </t>
                                            </t>
                                            </t>
                                        </tr>
                                    </t>
                                </table>
                            <table class="col-sm-12">
                                        <tr>
                                                <tr>
                                                    <td><span style="float:right;">Frais de rappel</span></td>
                                                    <td class="amount"><t t-esc="'%.2f' %  (fees)" /> €</td>
                                                </tr>
                                        </tr>
                                </table>
                        </div>
                    </div>
                </div>
			</t>

		</template>



        <template id="report_payment_info_amount_one_row_durbuy_med">
            <xpath expr="//head" position="inside">
                <link rel="stylesheet" href="/extraschool/static/src/css/report_payment_info_amount_one_row_durbuy_rappel.css"/>
            </xpath>
            <div class="row">
                <div class="col-sm-12">
                    <div  style="border-width: 1px;display:block;border-style: solid;width: 100%;page-break-inside: avoid;font-size: 13px;">
                        <div id="payment_info">
                            <span style="font-size: 15px;font-weight: bold;">Total à payer : <span style="float:right;"><t t-esc="'%.2f' %  (balance + fees)" /> €</span></span><br/>
                            <span>Échéance <span style="float:right;">avant le <t t-esc="payment_term" /></span></span><br/>
                            <span>Compte <span style="float:right;"><t t-esc="categ_id.bankaccount" /></span></span><br/>
                            <span>Communication structurée <span class="ecrit">obligatoire</span> <span style="float:right;"><t t-esc="reminder_com_struct"/></span></span>
                        </div>
                    </div>
                    <div style="margin-top:15px;">
                        <p>
                            <br/><span style="margin:30px;"><b>Un dernier délai de 15 jours </b> à dater de la présente mise en demeure vous est accordé pour
                                en effectuer le paiement.<br/></span>
                        </p>
                        <p>
                            <span style="margin:30px;">Vous me dispenseriez ainsi de vous appliquer les rigueurs que la loi prescrit dans votre cas
                                (Suivant l’article L1124-40 § 1er du Code de la Démocratie Locale et de la Décentralisation
                                (C.D.L.D)), qui consistent en <b>des poursuites par Maître Sikivie, Huissier de Justice à Barvaux S/O.</b><br/></span>
                        </p>
                        <p>
                            <span style="margin:30px;">Nous vous informons que seul le paiement intégral de la somme réclamée mettra fin à la procédure en cours.<br/></span>
                        </p>
                        <p>
                            <span style="margin:30px;">Nous vous prions de croire, Madame, Monsieur, Cher parent, en l’assurance de notre considération distinguée.<br/></span>
                        </p>
                    </div>
                </div>
                <div class="col-sm-3" style="float: right;display:block;margin-top:10px;">
                    <div style="display:block;">
                        <span t-esc="resp_name" /><br/>
                        <span style="border-top:30px;"> <t t-esc="resp_fct"/> </span>
                    </div>
                </div>
            </div>

		</template>

        <template id="report_payment_info_amount_one_row_durbuy">
			<xpath expr="//head" position="inside">
                <link rel="stylesheet" href="/extraschool/static/src/css/report_payment_info_amount_one_row_durbuy.css"/>
            </xpath>
			<div id="total_row">
				<div id="payment_info">
					<div>
					  <span>Total des frais de cette période d'accueil: </span><span class="amount"><t t-esc="'%.2f' %  (total)" /> €</span>
					</div>
					<div>
					  <span>Solde des périodes antérieures: </span><span class="amount"><t t-esc="'%.2f' %  (received)" /> €</span>
					</div>
					<div>
					  <span>Solde à payer: </span><span class="amount"><t t-esc="'%.2f' %  (balance)" /> €</span>
					</div><br/>
					<div>
						<span>Au numéro de compte: <b><t t-esc="categ_id.bankaccount" /></b></span>
					<!--<span style="margin-left:100px">BIC: <t t-esc="categ_id.bank_bic" /></span>-->
					</div>
					<div>
				    	Avec la communication structurée <b>obligatoire</b> : <t t-esc="parent_id.get_prepaid_comstruct(categ_id)" />
					</div>
					<div>
						<b><span> A payer avant le <t t-esc="payment_term" /></span></b>
					</div>
				</div>
			</div>
		</template>


        <template id="report_payment_info_amount_invoice_one_row_durbuy">
            <t t-set="zz" t-value="0" />
			<t t-foreach="summary_invoice_ids" t-as="summary_invoice">
				<t t-if="summary_invoice.id != invoice_id">
					<t t-set="zz" t-value="zz+1" />
				</t>
			</t>
			<xpath expr="//head" position="inside">
                <link rel="stylesheet" href="/extraschool/static/src/css/report_payment_info_amount_one_row.css"/>
            </xpath>
			<div id="total_row">

			<div id="payment_info">
				<span>Compte: <b><t t-esc="categ_id.bankaccount" /></b></span>
				<br />
				<span>BIC: <t t-esc="categ_id.bank_bic" /></span>
				<br />
				<div class="com_struct">
					<span>Communication structurée <b>obligatoire</b>:<br/>
                        <b><t t-esc="parent_id.get_prepaid_comstruct(categ_id)" /></b></span>
				</div>
			</div>
				<div id="total">
					<div class="amount">
					  <span class="zz_label">Total de cette facture</span><span class="amount"><t t-esc="'%.2f' %  (total)" /> €</span>
					</div>
					<div class="amount">
					  <span class="zz_label">Reçu</span><span class="amount"><t t-esc="'%.2f' %  (received)" /> €</span>
					</div>
                    <div class="amount" t-if="reminder_type == 'fix'">
                        <span class="zz_label">Frais de rappel</span><span class="amount"><t t-esc="'%.2f' %  (fees)" /> €</span>
                    </div>
                    <div class="amount to_pay" t-if="reminder_type == 'fix'">
                        <span class="zz_label">Solde</span><span class="amount"><t t-esc="'%.2f' %  (balance + fees)" /> €</span>
                    </div>
					<div class="amount to_pay" t-if="reminder_type == 'free'">
						<span class="zz_label">Solde</span><span class="amount"><t t-esc="'%.2f' %  (balance)" /> €</span>
					</div>
					<div class="amount to_pay" t-if="not reminder_type">
						<span class="zz_label">Solde de ce mois</span><span class="amount"><t t-esc="'%.2f' %  (balance)" /> €</span>
					</div>
                    <div class="amount to_pay">
                        <span class="zz_label">Solde factures échues ou en attente de paiement</span><span class="amount"><span t-esc="'%.2f €' % (sum([summary_invoice.balance for summary_invoice in summary_invoice_ids]))"/></span>
                    </div>
					<div class="amount to_pay">
					    <span class="zz_label"> Total à payer avant le <t t-esc="payment_term"/></span><span class="amount"><t t-esc="'%.2f' %  (parent_id.totalbalance)" /> €</span>
					</div>
				</div>
			</div>
		</template>

        <template id="report_footer_durbuy">
		    <xpath expr="//head" position="inside">
                <link rel="stylesheet" href="/extraschool/static/src/css/report_footer_durbuy.css"/>
            </xpath>
	    	<div class="aes_adresse">
				Les périodes sont facturées à raison de 0.25€ le quart d'heure entamé. Pour les départs après 17h30(18h30 Barvaux) les lundi,
					mardi, jeudi et vendredi et après 13h le mercredi (hors mercredi après-midi), un forfait de 10€ est comptabilisé par 1/4h
					entamé.
					Le mercredi après midi présente un forfait de 5€ pour toute l’après midi et l’école de devoirs, un forfait de 2.4€ par séance.
					En cas de retard ou de non paiement, le recouvrement sera poursuivi conformément à l’article L1124-40 1° du Code de la
					Démocratie Locale.
					Nous vous invitons à lire attentivement le Règlement d’Ordre Intérieur et le Projet Pédagogique de l’accueil extrascolaire reçu
					via votre enfant à l’école. Plus d’infos : Coordination Enfance, <a style="text-decoration:underline;">enfance@durbuy.be</a> ou 0473 301 771
			</div>
		</template>



	</data>
</odoo>
